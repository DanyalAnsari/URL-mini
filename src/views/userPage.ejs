<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
  <%- include('./partials/commonCSS.ejs') %>
    <style>
      .bi {
        display: inline-block;
        width: 1rem;
        height: 1rem;
      }

      /*
   * Sidebar
   */

      @media (min-width: 768px) {
        .sidebar .offcanvas-lg {
          position: -webkit-sticky;
          position: sticky;
          top: 48px;
        }

        .navbar-search {
          display: block;
        }
      }

      .sidebar .nav-link {
        font-size: .875rem;
        font-weight: 500;
      }

      .sidebar .nav-link.active {
        color: #2470dc;
      }

      .sidebar-heading {
        font-size: .75rem;
      }

      /*
   * Navbar
   */

      .navbar-brand {
        padding-top: .75rem;
        padding-bottom: .75rem;
        background-color: rgba(0, 0, 0, .25);
        box-shadow: inset -1px 0 0 rgba(0, 0, 0, .25);
      }

      .navbar .form-control {
        padding: .75rem 1rem;
      }
    </style>
    <title>URL-mini</title>
</head>

<body>
  <%- include('./partials/navbar.ejs') %>



    <header>
      <div class="px-3 py-2 text-bg-dark border-bottom">
        <div class="container">
          <div class="d-flex flex-wrap align-items-center justify-content-center justify-content-lg-start">
            <a href="/"
              class="d-flex align-items-center my-2 my-lg-0 me-lg-auto text-white text-decoration-none fs-1 mt-4 mb-5 fw-normal">
              URL-mini
            </a>

            <ul class="nav col-12 col-lg-auto my-2 justify-content-center my-md-0 text-small">
              <li>
                <a href="/home" class="nav-link text-white ">
                  <svg class="bi d-block mx-auto mb-1" width="24" height="24">
                    <use xlink:href="#home" />
                  </svg>
                  Home
                </a>
              </li>
              <li>
                <a href="#" class="nav-link text-secondary">
                  <svg class="bi d-block mx-auto mb-1" width="24" height="24">
                    <use xlink:href="#speedometer2" />
                  </svg>
                  Dashboard
                </a>
              </li>
              <li>
                <a href="#Statistics" class="nav-link text-white">
                  <svg class="bi d-block mx-auto mb-1" width="24" height="24">
                    <use xlink:href="#table" />
                  </svg>
                  Statistics
                </a>
              </li>
              <li>
                <a href="#" class="nav-link text-white">
                  <svg class="bi d-block mx-auto mb-1" width="24" height="24">
                    <use xlink:href="#people-circle" />
                  </svg>
                  <% if (locals.user ) { %>

                    <%= user.Username %>

                      <% } %>
                </a>
              </li>
            </ul>
          </div>
        </div>
      </div>
      <div class="px-3 py-2 border-bottom mb-3">
        <div class="container d-flex flex-wrap justify-content-between">
          <form class="w-100" action="/url/" method="post">
            <input type="text" class="form-control" placeholder="Your long URL" name="URL">
            <button type="submit" class="btn btn-warning text-dark my-4 mt-3">Generate</button>
          </form>
        </div>
      </div>
    </header>
    <section>
      <header class="navbar bg-dark flex-md-nowrap p-0 shadow" data-bs-theme="dark">
        <a class="navbar-brand col-md-3 col-lg-2 me-0 px-3 fs-6 text-white" href="#">URL-mini</a>

        <ul class="navbar-nav flex-row d-md-none">
          <li class="nav-item text-nowrap">
            <button class="nav-link px-3 text-white" type="button" data-bs-toggle="collapse"
              data-bs-target="#navbarSearch" aria-controls="navbarSearch" aria-expanded="false"
              aria-label="Toggle search">
              <svg class="bi">
                <use xlink:href="#search" />
              </svg>
            </button>
          </li>
          <li class="nav-item text-nowrap">
            <button class="nav-link px-3 text-white" type="button" data-bs-toggle="offcanvas"
              data-bs-target="#sidebarMenu" aria-controls="sidebarMenu" aria-expanded="false"
              aria-label="Toggle navigation">
              <svg class="bi">
                <use xlink:href="#list" />
              </svg>
            </button>
          </li>
        </ul>
      </header>

      <div class="container-fluid">
        <div class="row">
          <div class="sidebar border border-right col-md-3 col-lg-2 p-0 bg-body-tertiary">
            <div class="offcanvas-md offcanvas-end bg-body-tertiary" tabindex="-1" id="sidebarMenu"
              aria-labelledby="sidebarMenuLabel">
              <div class="offcanvas-header">
                <h5 class="offcanvas-title fw-bold" id="sidebarMenuLabel">URL-mini</h5>
                <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#sidebarMenu"
                  aria-label="Close"></button>
              </div>
              <div class="offcanvas-body d-md-flex flex-column p-0 pt-lg-3 overflow-y-auto">
                <ul class="nav flex-column">
                  <li class="nav-item">
                    <p class=" lead px-4 mt-3 fw-bold d-flex align-items-start gap-2" aria-current="page">
                      Username: <%= user.Username %>
                    </p>
                  </li>
                  <li class="nav-item">
                    <p class=" lead px-4 mt-3 fw-normal d-flex align-items-start gap-2" aria-current="page">
                      Email: <%= user.Email %>
                    </p>
                  </li>
                  <li class="nav-item">
                    <p class=" lead px-4 mt-3 fw-normal d-flex align-items-start gap-2" aria-current="page">
                      Total links creted: <%= data.length%>
                    </p>
                  </li>
                </ul>


                <hr class="my-3">

                <ul class="nav flex-column mb-auto">
                  <li class="nav-item">
                    <button class="nav-link d-flex align-items-center gap-2" id="AccontDelete">
                      <svg class="bi">
                        <use xlink:href="#gear-wide-connected" />
                      </svg>
                      Delete Account
                    </button>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link d-flex align-items-center gap-2" href="/user/signout">
                      <svg class="bi">
                        <use xlink:href="#door-closed" />
                      </svg>
                      Sign out
                    </a>
                  </li>
                </ul>
              </div>
            </div>
          </div>
          <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
            <div
              class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 py-2 border-bottom">
              <h1 class="h2">Dashboard</h1>
              <div class="btn-toolbar mb-2 mb-md-0">
                <div class="btn-group me-2">
                  <button type="button" class="btn btn-sm btn-outline-secondary">Export</button>
                </div>
                <button type="button"
                  class="btn btn-sm btn-outline-secondary dropdown-toggle d-flex align-items-center gap-1">
                  <svg class="bi">
                    <use xlink:href="#calendar3" />
                  </svg>
                  This week
                </button>
              </div>
            </div>
            <div class="d-flex align-items-center py-4 bg-body-tertiary">
              <canvas class="my-4 w-100" id="myChart" width="900" height="380"></canvas>
            </div>
    </section>
    <h2>Statistics</h2>
    <div class="table-responsive small" id="Statistics">
      <table class="table table-striped table-sm">
        <thead>
          <tr>
            <th scope="col">#</th>
            <th scope="col">List</th>
            <th scope="col">Short ID's</th>
            <th scope="col">Redirected URL's</th>
            <th scope="col">Visits</th>
          </tr>
        </thead>
        <tbody>
          <% if (locals.data) { %>
            <% data.forEach((URL, index)=> { %>
              <tr>
                <td>#</td>
                <th scope="row">
                  <%= index+1 %>
                </th>
                <td>
                  <%= URL.URLShortId %>
                </td>
                <td>
                  <%= URL.FullURL %>
                </td>
                <td>
                  <%= URL.Visits.length %>
                </td>
              </tr>
              <% }) %>
                <% } else { %>
                  <tr>
                    <td>#</td>
                    <th scope="row">
                      ----
                    </th>
                    <td>
                      ----
                    </td>
                    <td>
                      ----
                    </td>
                    <td>
                      ----
                    </td>
                  </tr>
                  <% } %>
        </tbody>
      </table>
    </div>
    </main>
    </div>
    </div>
    </div>
    <script src="../assets/dist/js/bootstrap.bundle.min.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.3.2/dist/chart.umd.js"
      integrity="sha384-eI7PSr3L1XLISH8JdDII5YN/njoSsxfbrkCTnJrzXt+ENP5MOVBxD+l6sEG4zoLp"
      crossorigin="anonymous"></script>
    <script src="dashboard.js"></script>
</body>

</html>





<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
  integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
<script>/* globals Chart:false */

  (() => {
    'use strict'

    // Graphs
    const ctx = document.getElementById('myChart')
    // eslint-disable-next-line no-unused-vars
    const myChart = new Chart(ctx, {
      type: 'line',
      data: {
        labels: [
          'Sunday',
          'Monday',
          'Tuesday',
          'Wednesday',
          'Thursday',
          'Friday',
          'Saturday'
        ],
        datasets: [{
          data: [
            15339,
            21345,
            18483,
            24003,
            23489,
            24092,
            12034
          ],
          lineTension: 0,
          backgroundColor: 'transparent',
          borderColor: '#007bff',
          borderWidth: 4,
          pointBackgroundColor: '#007bff'
        }]
      },
      options: {
        plugins: {
          legend: {
            display: true
          },
          tooltip: {
            boxPadding: 3
          }
        }
      }
    })
  })()
</script>
<script>
  const AccontDelete = document.getElementById('AccontDelete');

  AccontDelete.addEventListener('click', async () => {
    const response = await fetch('/user/', { method: 'DELETE' });
  })
</script>
</body>

</html>